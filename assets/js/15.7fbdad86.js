(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{526:function(e,r,t){"use strict";t.r(r);var a=t(2),n=Object(a.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("p",[t("strong",[e._v("æœ¬æ–‡æ—¨åœ¨è®°å½•é¢˜ä¸»æ¬ç –é€”ä¸­æ‰€é‡æ‰€æƒ³ã€‚")]),e._v(" "),t("Boxx")],1),e._v(" "),t("h2",{attrs:{id:"å‰è¨€èƒŒæ™¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€èƒŒæ™¯"}},[e._v("#")]),e._v(" å‰è¨€èƒŒæ™¯")]),e._v(" "),t("p",[e._v("æœ€è¿‘æ¥æ‰‹äº†æŸæ´»åŠ¨ç»Ÿè®¡æŠ¥è¡¨å¹³å°ä¸è¿è¥å¹³å°çš„éƒ¨åˆ†éœ€æ±‚ï¼Œå…¶ä¸­åŒ…å« excel ä¸‹è½½ç­‰ï¼Œæƒ³èµ·æ¥ä¹‹å‰åœ¨è¥é”€ç»„æ—¶å¼€å‘çµçŠ€å¹³å°é‡åˆ°çš„ excelã€scv ä¸‹è½½åœºæ™¯ï¼Œæ—¶éš”è®¸ä¹…ä¹Ÿç®—æ˜¯è¡¥ä¸Šå½“æ—¶æƒ³å†™ä½†ä¸€ç›´æœªå†™çš„å‘ã€‚")]),e._v(" "),t("h2",{attrs:{id:"è§£å†³æ–¹æ¡ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#è§£å†³æ–¹æ¡ˆ"}},[e._v("#")]),e._v(" è§£å†³æ–¹æ¡ˆ")]),e._v(" "),t("p",[e._v("ä¸€èˆ¬æ¥è®²ä¸‹è½½æ–‡ä»¶å¸¸ç”¨çš„(ç›®å‰æˆ‘ç”¨è¿‡çš„:)æœ‰ä¸¤ç§æ–¹å¼:")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("é€šè¿‡ download æ¥å£å‘ŠçŸ¥åç«¯éœ€è¦ä¸‹è½½çš„æ•°æ®ï¼Œç”±åç«¯ç”Ÿæˆæ–‡ä»¶å­˜å‚¨åè¿”å›ç»™å‰ç«¯ç›¸åº”çš„ä¸‹è½½ urlï¼Œå‰ç«¯é€šè¿‡è¯¥ url è¿›è¡Œä¸‹è½½ã€‚(æ¸…åˆ†æŠ¥è¡¨ä½¿ç”¨è¯¥æ–¹å¼ï¼Œåç«¯æ¯æ—¥ä¼šæœ‰å®šæ—¶ä»»åŠ¡äº§ç”Ÿæ‰€éœ€ä¸‹è½½æ–‡ä»¶å¹¶å°†å¤„ç†ç»“æœè¿›è¡Œç¼“å­˜ï¼Œå‰ç«¯è¯·æ±‚æ—¶ç›´æ¥ä»ç¼“å­˜è·å–) æœ¬æ¬¡ä¸åœ¨èµ˜è¿°ç›¸å…³ç»†èŠ‚ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("é€šè¿‡ download æ¥å£å‘ŠçŸ¥åç«¯éœ€è¦ä¸‹è½½çš„æ•°æ®ï¼Œåç«¯è¿”å›æ–‡ä»¶æµåé€šè¿‡"),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Blob",target:"_blank",rel:"noopener noreferrer"}},[e._v("Blob"),t("OutboundLink")],1),e._v("ï¼Œä»¥åŠåˆ›å»º"),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/URL/createObjectURL",target:"_blank",rel:"noopener noreferrer"}},[e._v("å¯¹è±¡ URL"),t("OutboundLink")],1),e._v("ç­‰æ“ä½œæ¥å®ç°ä¸‹è½½ã€‚")])])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// ä»¥ä¸‹ä¸ºç®€å•ğŸŒ°:\nfunction downloadFile(data, fileName) {\n    let blob = new Blob([data], {\n        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8'\n    })\n\n    if (window.navigator.msSaveBlob) {\n        window.navigator.msSaveBlob(blob, fileName || 'pub.xlsx')\n        return false\n    }\n\n    const aEl = document.createElement('a)\n    const body = document.querySelector('body')\n    aEl.download = fileName || 'pub.xlsl'\n    aEl.style.display = 'none'\n    aEl.href = URL.createObjectURL(blob)\n    body.appendChild(aEl)\n    aEl.click()\n    body.removeChild(aEl)\n    // é‡Šæ”¾ URLå¯¹è±¡\n    URL.revokeObjectURL(aEl.href)\n}\n\n\n")])])]),t("div",{staticClass:"custom-block warning"},[t("ul",[t("li",[t("p",[e._v("åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¥å£å“åº”çš„æ•°æ®ç±»å‹æ˜¯ DOMStringã€‚ç”±äºæœåŠ¡ç«¯è¿”å›çš„æ˜¯æ–‡ä»¶æµï¼Œå½“æˆ‘ä»¬ä¸è®¾ç½®"),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/responseType",target:"_blank",rel:"noopener noreferrer"}},[e._v("responseType"),t("OutboundLink")],1),e._v("ä¸º blob æ—¶ï¼Œä¼šå‘ç°ä¸‹è½½çš„æ–‡ä»¶å‘ç”Ÿå¼‚å¸¸ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("è¯¥æ–¹å¼åœ¨ IE ä¸‹éœ€ä½¿ç”¨"),t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/msSaveBlob",target:"_blank",rel:"noopener noreferrer"}},[e._v("msSaveBlob"),t("OutboundLink")],1),e._v("è¿›è¡Œå…¼å®¹å¤„ç†ã€‚")])]),e._v(" "),t("li",[t("p",[e._v("ä¸åç«¯çº¦å®šè¿”å›ä¿¡æ¯ typeï¼Œç”¨æ¥åˆ¤æ–­å½“å‰å“åº”çŠ¶æ€ã€‚å½“æ¥å£å“åº”å¼‚å¸¸æ—¶ï¼Œç”±äºåç«¯è¿”å›çš„ä¿¡æ¯æ˜¯ Blobï¼Œå…¶åŒ…å«çš„æ­£å¸¸é”™è¯¯ä¿¡æ¯æ— æ³•æ•è·ï¼Œéœ€è¦å…ˆå¤„ç†ä¸º JSON æ ¼å¼ã€‚")])])])]),e._v(" "),t("h4",{attrs:{id:"æ­£å¸¸è¿”å›"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ­£å¸¸è¿”å›"}},[e._v("#")]),e._v(" æ­£å¸¸è¿”å›:")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://cyi113.oss-cn-shanghai.aliyuncs.com/static/download_msg1.png",alt:""}})]),e._v(" "),t("h4",{attrs:{id:"å¼‚å¸¸è¿”å›"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¼‚å¸¸è¿”å›"}},[e._v("#")]),e._v(" å¼‚å¸¸è¿”å›:")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://cyi113.oss-cn-shanghai.aliyuncs.com/static/download_msg2.png",alt:""}})]),e._v(" "),t("h4",{attrs:{id:"å¼‚å¸¸è¿”å›æŠ¥æ–‡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å¼‚å¸¸è¿”å›æŠ¥æ–‡"}},[e._v("#")]),e._v(" å¼‚å¸¸è¿”å›æŠ¥æ–‡:")]),e._v(" "),t("p",[t("img",{attrs:{src:"https://cyi113.oss-cn-shanghai.aliyuncs.com/static/download_msg3.png",alt:""}})]),e._v(" "),t("p",[e._v("å¤„ç†å¼‚å¸¸è¿”å›æŠ¥æ–‡"),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader",target:"_blank",rel:"noopener noreferrer"}},[e._v("FileReader"),t("OutboundLink")],1),e._v(":")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("// ç®€å•ğŸŒ°:\nfunction onClick() {\n    // è¯·æ±‚è¿”å› dataï¼Œåˆ¤æ–­è¿”å›æ•°æ®æ˜¯å¦æ­£å¸¸\n    if (data.type === 'application/json') {\n        handleErrorTip(data)\n        return false\n    }\n\n    // download\n}\n\nfunction handleErrorTip(data) {\n    const fileReader = new FileReader()\n    fileReader.onload = () => {\n        const result = JSON.parse(fileReader.result)\n        this.$message.error(result.message)\n    }\n\n    fileReader.readAsText(data, 'utf-8')\n}\n")])])]),t("h4",{attrs:{id:"ç›‘å¬ä¸‹è½½è¿›åº¦"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ç›‘å¬ä¸‹è½½è¿›åº¦"}},[e._v("#")]),e._v(" ç›‘å¬ä¸‹è½½è¿›åº¦")]),e._v(" "),t("p",[e._v("åŸç”Ÿ Ajax æœ‰ä¸€ä¸ªç›‘æµ‹è¿›åº¦äº‹ä»¶"),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/ProgressEvent",target:"_blank",rel:"noopener noreferrer"}},[e._v("progress"),t("OutboundLink")],1),e._v("ï¼Œè¯¥äº‹ä»¶ä¼šåœ¨æ¥æ”¶æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘ï¼Œå®é™…ä¸Šæˆ‘ä»¬åªéœ€è¦å…³æ³¨è¯¥äº‹ä»¶è¿”å›çš„ loadedã€total å±æ€§å€¼ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œä½¿ç”¨çš„ç¬¬ä¸‰æ–¹å°è£…çš„è¯·æ±‚åº“æ—¶ï¼Œå…¶å·²ç»å¯¹è¯¥åŸç”Ÿäº‹ä»¶è¿›è¡Œäº†åŒ…è£…æš´éœ²ï¼Œå¦‚ axios é‡Œçš„ onDownloadProgressï¼ŒonUploadProgress æ–¹æ³•ã€‚")]),e._v(" "),t("h2",{attrs:{id:"æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#æ€»ç»“"}},[e._v("#")]),e._v(" æ€»ç»“")]),e._v(" "),t("p",[e._v("åç»­ä¼šæ›´æ–°å¤§æ–‡ä»¶ä¸‹è½½ç›¸å…³ç»†èŠ‚ï¼Œæš‚æ—¶å…ˆå¼€ä¸ªå‘ã€‚")]),e._v(" "),t("h4",{attrs:{id:"å‚è€ƒä¿¡æ¯"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒä¿¡æ¯"}},[e._v("#")]),e._v(" å‚è€ƒä¿¡æ¯")]),e._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://github.com/eligrey/FileSaver.js",target:"_blank",rel:"noopener noreferrer"}},[e._v("FileSaver"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Blob",target:"_blank",rel:"noopener noreferrer"}},[e._v("Blob"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/URL/createObjectURL",target:"_blank",rel:"noopener noreferrer"}},[e._v("å¯¹è±¡ URL"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Navigator/msSaveBlob",target:"_blank",rel:"noopener noreferrer"}},[e._v("msSaveBlob"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/FileReader",target:"_blank",rel:"noopener noreferrer"}},[e._v("FileReader"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/responseType",target:"_blank",rel:"noopener noreferrer"}},[e._v("responseType"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types",target:"_blank",rel:"noopener noreferrer"}},[e._v("å¸¸è§ MIME ç±»å‹åˆ—è¡¨"),t("OutboundLink")],1)])]),e._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/97768916",target:"_blank",rel:"noopener noreferrer"}},[e._v("å…¶ä»–èµ„æ–™"),t("OutboundLink")],1)])])])])}),[],!1,null,null,null);r.default=n.exports}}]);